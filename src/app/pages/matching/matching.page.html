<ion-content class="ion-padding">
  @if (isLoading) {
    <div>Chargement des matches...</div>
  } @else {
    @if (!userId) {
      <div>Veuillez vous connecter pour voir les matches.</div>
    } @else {
      @if (matches && matches.length > 0) {
        <ion-list style="margin-top: 2.5rem;">
          <ion-label><small>Ils suivent les mêmes films que vous</small></ion-label>
          @for (m of matches; track m.userId) {
            <ion-item lines="none">
              <ion-label>
                <h3>{{ m.displayName }}</h3>
                <p>{{ m.commonCount }} films en commun ({{ m.matchPercentage | number:'1.0-2' }}%)</p>
                <div class="common-movies">
                  @for (mid of m.commonMovieIds; track mid) {
                    <a [routerLink]="['/tabs/movie', mid]" class="common-movie">
                      <img [src]="getPosterForId(mid)" alt="" />
                      <small>{{ movieDetailsMap[mid]?.title || '—' }}</small>
                    </a>
                  }
                </div>
              </ion-label>
            </ion-item>
          }
        </ion-list>
      } @else {
        <div>Aucun match trouvé pour l'instant (75% de similarité requise).</div>
      }
    }
  }
</ion-content>